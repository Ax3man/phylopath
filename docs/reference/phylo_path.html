<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Compare causal models in a phylogenetic context. — phylo_path • phylopath</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Compare causal models in a phylogenetic context. — phylo_path"><meta property="og:description" content="Continuous variables are modeled using phylolm::phylolm, while binary
traits are modeled using phylolm::phyloglm."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">phylopath</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/intro_to_phylopath.html">Get started</a>
</li>
<li>
  <a href="../articles/binary_models.html">Binary data</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/Ax3man/phylopath" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compare causal models in a phylogenetic context.</h1>
    <small class="dont-index">Source: <a href="https://github.com/Ax3man/phylopath/blob/HEAD/R/phylopath.R" class="external-link"><code>R/phylopath.R</code></a></small>
    <div class="hidden name"><code>phylo_path.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Continuous variables are modeled using <a href="https://rdrr.io/pkg/phylolm/man/phylolm.html" class="external-link">phylolm::phylolm</a>, while binary
traits are modeled using <a href="https://rdrr.io/pkg/phylolm/man/phyloglm.html" class="external-link">phylolm::phyloglm</a>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">phylo_path</span><span class="op">(</span></span>
<span>  <span class="va">model_set</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">tree</span>,</span>
<span>  model <span class="op">=</span> <span class="st">"lambda"</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"logistic_MPLE"</span>,</span>
<span>  order <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  na.rm <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>model_set</dt>
<dd><p>A list of directed acyclic graphs. These are matrices,
typically created with <code>define_model_set</code>.</p></dd>


<dt>data</dt>
<dd><p>A <code>data.frame</code> with data. If you have binary variables, make
sure they are either character values or factors!</p></dd>


<dt>tree</dt>
<dd><p>A phylogenetic tree of class <code>phylo</code>.</p></dd>


<dt>model</dt>
<dd><p>The evolutionary model used for the regressions on continuous
variables. See <a href="https://rdrr.io/pkg/phylolm/man/phylolm.html" class="external-link">phylolm::phylolm</a> for options and details. Defaults to
Pagel's lambda model</p></dd>


<dt>method</dt>
<dd><p>The estimation method for the binary models. See
<a href="https://rdrr.io/pkg/phylolm/man/phyloglm.html" class="external-link">phylolm::phyloglm</a> for options and details. Defaults to logistic MPLE.</p></dd>


<dt>order</dt>
<dd><p>Causal order of the included variable, given as a character
vector. This is used to determine which variable should be the dependent
in the dsep regression equations. If left unspecified, the order will be
automatically determined. If the combination of all included models is
itself a DAG, then the ordering of that full model is used. Otherwise,
the most common ordering between each pair of variables is used to create
a general ordering.</p></dd>


<dt>parallel</dt>
<dd><p><em>Superseded</em> From v1.2 <code>phylopath</code> uses the <code>future</code> package
for all parallel processing, see details.</p></dd>


<dt>na.rm</dt>
<dd><p>Should rows that contain missing values be dropped from the data
as necessary (with a message)?</p></dd>


<dt>...</dt>
<dd><p>Arguments passed on to <code>phylolm</code>:</p>
<p><code>lower.bound</code>: optional lower bound for the optimization of the phylogenetic model parameter.</p>
<p><code>upper.bound</code>: optional upper bound for the optimization of the phylogenetic model parameter.</p>
<p><code>starting.value</code>: optional starting value for the optimization of the phylogenetic model parameter.</p>
<p><code>measurement_error</code>: a logical value indicating whether there is measurement error sigma2_error (see Details).</p>
<p>Arguments passed on to <code>phyloglm</code>:</p>
<p><code>btol</code>: bound on the linear predictor to bound the searching space.</p>
<p><code>log.alpha.bound</code>: bound for the log of the parameter alpha.</p>
<p><code>start.beta</code>: starting values for beta coefficients.</p>
<p><code>start.alpha</code>: starting values for alpha (phylogenetic correlation).</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A phylopath object, with the following components:</p><dl><dt>d_sep</dt>
<dd><p>for each model a table with separation statements and statistics.</p></dd>

<dt>model_set</dt>
<dd><p>the DAGs</p></dd>

<dt>data</dt>
<dd><p>the supplied data</p></dd>

<dt>tree</dt>
<dd><p>the supplied tree</p></dd>

<dt>model</dt>
<dd><p>the employed model of evolution in <code>phylolm</code></p></dd>

<dt>method</dt>
<dd><p>the employed method in <code>phyloglm</code></p></dd>

<dt>dots</dt>
<dd><p>any additional arguments given, these are passed on to downstream functions</p></dd>

<dt>warnings</dt>
<dd><p>any warnings generated by the models</p></dd>


</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p><em>Parallel processing</em>: From v1.2, <code>phylopath</code> uses the <code>future</code> framework
for parallel processing. This is compatible with the parallel computation
within the underlying <code>phylolm</code>, making it easy to enable parallel
processing of multiple models, and of bootstrap replicates. To enable,
simply set a parallel <code>plan()</code> using the <code>future</code> package. Typically, you'll
want to run <code>future::plan("multisession", workers = n)</code>, where <code>n</code> is the
number of cores. Now parallel processing is enabled. Return to sequential
processing using <code>future::plan("sequential")</code></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="co">#see vignette('intro_to_phylopath') for more details</span></span></span>
<span class="r-in"><span>  <span class="va">candidates</span> <span class="op">&lt;-</span> <span class="fu"><a href="define_model_set.html">define_model_set</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    A <span class="op">=</span> <span class="va">NL</span> <span class="op">~</span> <span class="va">BM</span>,</span></span>
<span class="r-in"><span>    B <span class="op">=</span> <span class="va">NL</span> <span class="op">~</span> <span class="va">LS</span>,</span></span>
<span class="r-in"><span>    .common <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">LS</span> <span class="op">~</span> <span class="va">BM</span>, <span class="va">DD</span> <span class="op">~</span> <span class="va">NL</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">phylo_path</span><span class="op">(</span><span class="va">candidates</span>, <span class="va">rhino</span>, <span class="va">rhino_tree</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Printing p gives some general information:</span></span></span>
<span class="r-in"><span>  <span class="va">p</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A phylogenetic path analysis, on the variables:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Continuous:	 BM LS NL DD </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Binary:		  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Evaluated for these models: A B </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Containing 6 phylogenetic regressions, of which 4 unique</span>
<span class="r-in"><span>  <span class="co"># And the summary gives statistics to compare the models:</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   model k q     C       p CICc delta_CICc        l        w</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A     A 3 7  2.65 0.85113 17.9        0.0 1.00e+00 1.00e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> B     B 3 7 22.11 0.00115 37.3       19.5 5.94e-05 5.94e-05</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Wouter van der Bijl.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

