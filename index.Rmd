---
title: "Easy phylogenetic path analysis in R"
author: "Wouter van der Bijl"
date: "July 5, 2017"
output: html_document
---

```{r, include = FALSE}
knitr::opts_chunk$set(dev = "png", fig.height = 7, fig.width = 7, dpi = 300, out.width = "600px",
                      fig.align = 'center')
```

#Easy phylogenetic path analysis in R

Use the `phylopath` package for an easy to use framework to perform phylogenetic path analysis (PPA).

PPA can be used to compare support for competing causal models of trait evolution, while taking shared ancesty into account. All you need is:
1. A clear set of models to test.
2. A data set of species with trait values.
3. A phylogeny of your species.

For a complete worked example, click "Get Started" above, or see the [bioRxiv paper](doi.org/10.1101/212068).

This method was developed by Von Hardenberg and Gonzalez-Voyer. See `citation()` for info on correct citations.

```{r, echo = FALSE}
library(phylopath)

models <- list(
  one   = DAG(LS ~ BM, NL ~ BM, DD ~ NL, RS ~ DD),
  two   = DAG(LS ~ BM, NL ~ BM, DD ~ NL, RS ~ LS + DD),
  three = DAG(LS ~ BM, NL ~ BM, DD ~ NL, RS ~ NL),
  four  = DAG(LS ~ BM, NL ~ BM, DD ~ NL, RS ~ BM + NL),
  five  = DAG(LS ~ BM, NL ~ BM, DD ~ NL, RS ~ BM + NL + DD),
  six   = DAG(LS ~ BM, NL ~ BM + RS, DD ~ NL, RS ~ BM),
  seven = DAG(LS ~ BM, NL ~ BM + RS, DD ~ NL, RS ~ LS + BM),
  eight = DAG(LS ~ BM, NL ~ BM + RS, DD ~ NL),
  nine  = DAG(LS ~ BM, NL ~ BM + RS, DD ~ NL, RS ~ LS)
)

plot_model_set(models, rotation = -57, flip_x = TRUE)
```

```{r, echo = FALSE}
result <- phylo_path(models, data = rhino, tree = rhino_tree, 
                     order = c('BM', 'NL', 'DD', 'LS', 'RS'))
#plot(choice(result, 'five'), rotation = 9.45, curvature = -0.0000001, flip_x = TRUE)
plot(choice(result, 'five'), rotation = 10, curvature = -0.05, flip_x = TRUE)
```

The following published papers use `phylopath`:

* Liao, W. B., Huang, Y., Zeng, Y., Zhong, M. J., Luo, Y. and Lüpold, S. (2018), Ejaculate evolution in external fertilizers: Influenced by sperm competition or sperm limitation? Evolution, 72: 4–17. [doi:10.1111/evo.13372](https://doi.org/10.1111/evo.13372)

* Lin Zhang, Kun Guo, Guang-Zheng Zhang, Long-Hui Lin and Xiang Ji (2018), Evolutionary transitions in body plan and reproductive mode alter maintenance metabolism in squamates. BMC Evo Biol, 18:45. [doi:10.1186/s12862-018-1166-5](https://doi.org/10.1186/s12862-018-1166-5)

* Xin Yu, Mao Jun Zhong, Da Yong Li, Long Jin, Wen Bo Liao and Alexander Kotrschal (2018). Large‐brained frogs mature later and live longer. Evolution. [doi:10.1111/evo.13478](https://doi.org/10.1111/evo.13478).

Send me a message to add yours to the list.
